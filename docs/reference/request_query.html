<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a LOBSTER data request (one row per trading day) — request_query • lobsteR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a LOBSTER data request (one row per trading day) — request_query"><meta name="description" content="Construct a request describing which trading-day files to ask LOBSTER for.
For each symbol and date range the function expands the range to one row per
calendar day, converts the level to integer, and (optionally) validates the
requested days by removing weekends, NYSE holidays and any days already
present in the provided account archive."><meta property="og:description" content="Construct a request describing which trading-day files to ask LOBSTER for.
For each symbol and date range the function expands the range to one row per
calendar day, converts the level to integer, and (optionally) validates the
requested days by removing weekends, NYSE holidays and any days already
present in the provided account archive."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lobsteR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/voigtstefan/lobster/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a LOBSTER data request (one row per trading day)</h1>
      <small class="dont-index">Source: <a href="https://github.com/voigtstefan/lobster/blob/HEAD/R/request.R" class="external-link"><code>R/request.R</code></a></small>
      <div class="d-none name"><code>request_query.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Construct a request describing which trading-day files to ask LOBSTER for.
For each symbol and date range the function expands the range to one row per
calendar day, converts the level to integer, and (optionally) validates the
requested days by removing weekends, NYSE holidays and any days already
present in the provided account archive.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">request_query</span><span class="op">(</span></span>
<span>  <span class="va">symbol</span>,</span>
<span>  <span class="va">start_date</span>,</span>
<span>  <span class="va">end_date</span>,</span>
<span>  <span class="va">level</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  account_archive <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"1 day"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-symbol">symbol<a class="anchor" aria-label="anchor" href="#arg-symbol"></a></dt>
<dd><p>character vector One or more ticker symbols (e.g. "AAPL").
Each element is paired with the corresponding elements of <code>start_date</code>,
<code>end_date</code> and <code>level</code>. Recycling follows base R rules; mismatched lengths
should be avoided.</p></dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a></dt>
<dd><p>Date-like (Date or character) Start date(s) for the
requested range(s). Each start date is converted with <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>.</p></dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a></dt>
<dd><p>Date-like (Date or character) End date(s) for the
requested range(s). Each end date is converted with <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>integer(1) Required order-book snapshot level (e.g. 1, 2).</p></dd>


<dt id="arg-validate">validate<a class="anchor" aria-label="anchor" href="#arg-validate"></a></dt>
<dd><p>logical(1) If TRUE (default) remove weekend days and NYSE
holidays and — when <code>account_archive</code> is supplied — remove days already
present in the account archive.</p></dd>


<dt id="arg-account-archive">account_archive<a class="anchor" aria-label="anchor" href="#arg-account-archive"></a></dt>
<dd><p>data.frame or tibble, optional Archive table as
returned by <code><a href="account_archive.html">account_archive()</a></code>. When provided, rows that match
(symbol, start_date, end_date, level, size, download, id) are excluded
from the returned request.</p></dd>


<dt id="arg-frequency">frequency<a class="anchor" aria-label="anchor" href="#arg-frequency"></a></dt>
<dd><p>character(1), defaults to "1 day". Frequency string passed to request data.
For large data ranges, it may be beneficial to request data at a lower frequency,
e.g. "1 month" to reduce the number of requests to the lobster server.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble (data.frame) with one row per trading day and columns:</p><ul><li><p>symbol: character</p></li>
<li><p>start_date: Date</p></li>
<li><p>end_date: Date (equal to start_date for daily requests)</p></li>
<li><p>level: integer</p></li>
</ul><p>The function returns only the days that remain after optional validation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function does not perform network activity. Use
<code><a href="request_submit.html">request_submit()</a></code> to send the generated requests to the authenticated
LOBSTER session.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Single symbol, one-month range</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">request_query</span><span class="op">(</span><span class="st">"AAPL"</span>, <span class="st">"2020-01-01"</span>, <span class="st">"2020-01-31"</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple symbols / ranges (vectorised inputs)</span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op">&lt;-</span> <span class="fu">request_query</span><span class="op">(</span></span></span>
<span class="r-in"><span>  symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAPL"</span>, <span class="st">"MSFT"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-02-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2020-01-03"</span>, <span class="st">"2020-02-03"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karol Kulma, Stefan Voigt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

